-- 4장 문제
--특정 알파벳에 해당되는 사원을 찾으려고 합니다. FIRST_NAME이'K'로 시작 하거나   LASTNAME의 마지막이 'a'로 끝나는 
--사원들을 모두 찾아 FULL_NAME으로 열 레이블을 지정합니다. 이 열 레이블은 각 사원의 SALARY가 작은 것에서 큰 순으로 나열합니다.
--FIRST, LAST 를 합쳐 열 레이블에 저장하며 FIRST_NAME, LAST_NAME 각각의 첫 글자는 대문자여야 합니다.
 
SELECT FIRST_NAME, LAST_NAME, SALARY, INITCAP(FIRST_NAME)||' '||INITCAP(LAST_NAME) AS FULL_NAME
FROM EMPLOYEES
WHERE SUBSTR(FIRST_NAME,1,1) = 'K' OR SUBSTR(LAST_NAME,-1,1)='a'
ORDER BY SALARY ASC;
 
--5장 문제
--COMMISSION_PCT의 1000을 곱한 값과 SALARY를 합한 값을 SUM_SALARY로 열 레이블을 지정합니다. 이 합한 값을 기준으로
--9000보다 많으면 'HIGH', 4000보다 적으면 'LOW', 이 외에는 'AVERAGE'를 열 레이블 RESULT로  지정합니다.

SELECT EMPLOYEE_ID, SALARY, COMMISSION_PCT*1000, SALARY+NVL(COMMISSION_PCT*1000,0) SUM_SALARY,
(CASE 
WHEN SALARY+NVL(COMMISSION_PCT*1000,0)>9000 THEN 'HIGH'
WHEN SALARY+NVL(COMMISSION_PCT*1000,0)<4000 THEN 'LOW'
ELSE 'AVR' END) AS RESULT
FROM EMPLOYEES;