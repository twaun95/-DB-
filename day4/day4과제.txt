--DAY4과제
-- 1. 사원 테이블에서 매니저가 같은 사원들 (MANAGER_ID) 중에서 같은 JOB_ID를 가지고 있는 사원들에 대해서 총 몇명이 있는지
-- 와 사원들의 급여에 대한 평균값을 조회

SELECT MANAGER_ID, JOB_ID, COUNT(*),  AVG(SALARY)
FROM EMPLOYEES
GROUP BY MANAGER_ID, JOB_ID;


-- 2.'ADMINISTRATION' 이름을 가진 부서에서 근무하고 있는 사원들의 급여의 합계를 조회(DEPARTMENTS, EMPLOYEES 테이블 JOIN / SUM 그룹함수)

SELECT D. DEPARTMENT_NAME, SUM(E.SALARY)
FROM DEPARTMENTS D, EMPLOYEES E
WHERE D.DEPARTMENT_NAME = 'Administration' AND D.DEPARTMENT_ID = E.DEPARTMENT_ID
GROUP BY D.DEPARTMENT_NAME;


-- 3. 'Seattle'이란 도시에 근무하고 있는 사원의 번호와 사원의 이름(LAST_NAME)과 부서이름을 조회(JOIN)

SELECT L.CITY, E.EMPLOYEE_ID, E.LAST_NAME,D.DEPARTMENT_NAME
FROM DEPARTMENTS D, EMPLOYEES E, LOCATIONS L
WHERE L.CITY='Seattle' AND L.LOCATION_ID=D.LOCATION_ID AND D.DEPARTMENT_ID=E.DEPARTMENT_ID;


-- 4. 부서의 급여의 평균급여가 7000보다 더 큰 부서의 ID와 해당 부서의 평균급여를 조회.(HAVING)

SELECT DEPARTMENT_ID, AVG(SALARY)
FROM EMPLOYEES
GROUP BY DEPARTMENT_ID
HAVING AVG(SALARY) > 7000;

